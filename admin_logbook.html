<!DOCTYPE html>
<html>
<head>
  <title>Logbook Report - Alif Edu</title>
  <style>
    body {
      margin: 0;
      font-family: 'Segoe UI', sans-serif;
      background: linear-gradient(to bottom right, navy, goldenrod);
      color: white;
    }

    .topbar {
      background-color: goldenrod;
      color: navy;
      padding: 1rem;
      text-align: center;
      font-size: 1.5rem;
      font-weight: bold;
    }

    .logo {
      height: 40px;
      vertical-align: middle;
      margin-right: 10px;
    }

    .container {
      padding: 2rem;
    }

    .card {
      background: white;
      color: black;
      border-radius: 15px;
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.25);
      padding: 2rem;
      overflow-x: auto;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 1rem;
    }

    th, td {
      border: 1px solid #ddd;
      padding: 8px;
      font-size: 14px;
    }

    th {
      background-color: navy;
      color: white;
    }

    .btn {
      background-color: goldenrod;
      color: navy;
      padding: 10px 20px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-weight: bold;
      margin-bottom: 1rem;
    }

    .btn:hover {
      background-color: #d4a017;
    }

    .back-btn {
      margin-top: 20px;
    }
  </style>
</head>
<body>
  <div class="topbar">
    <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/e/e0/Alif.svg/800px-Alif.svg.png" class="logo" alt="Alif Logo">
    Logbook Viewer - Principal Dashboard
  </div>

  <div class="container">
    <button class="btn" onclick="downloadPDF()">Download as PDF</button>
    <div class="card" id="logbookContainer">
      <h3>Logbook Records</h3>
      <table id="logbookTable">
        <thead id="theadRow"></thead>
        <tbody id="tbodyRows"></tbody>
      </table>
    </div>
    <button class="btn back-btn" onclick="goBack()">‚Üê Back to Dashboard</button>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script>
    const WEB_APP_URL = "https://script.google.com/macros/s/AKfycby51sQL3xo9pIqc7WO6-gUCQhCpkL0JN-4HclaAWbjaRsDrUCD4gD7zc47PVSfn9A8jgA/exec"; // e.g., https://script.google.com/macros/s/AKfycbxxxxxx/exec

    fetch(WEB_APP_URL)
      .then(res => res.json())
      .then(data => {
        const headers = Object.keys(data[0]);
        const thead = document.getElementById("theadRow");
        const tbody = document.getElementById("tbodyRows");

        // Add table header
        const headerRow = document.createElement("tr");
        headers.forEach(h => {
          const th = document.createElement("th");
          th.innerText = h;
          headerRow.appendChild(th);
        });
        thead.appendChild(headerRow);

        // Add table rows
        data.forEach(row => {
          const tr = document.createElement("tr");
          headers.forEach(h => {
            const td = document.createElement("td");
            td.innerText = row[h];
            tr.appendChild(td);
          });
          tbody.appendChild(tr);
        });
      });

    function goBack() {
      window.history.back();
    }

    function downloadPDF() {
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF();
      doc.text("Logbook Report", 10, 10);
      doc.autoTable({ html: '#logbookTable' });
      doc.save("logbook_report.pdf");
    }
  </script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.28/jspdf.plugin.autotable.min.js"></script>
</body>
</html>
