<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Principal Logbook Dashboard</title>
  <link rel="stylesheet" href="https://cdn.datatables.net/1.13.6/css/jquery.dataTables.min.css">
  <link rel="stylesheet" href="https://cdn.datatables.net/buttons/2.4.1/css/buttons.dataTables.min.css">
  <script src="https://code.jquery.com/jquery-3.7.0.js"></script>
  <script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
  <script src="https://cdn.datatables.net/buttons/2.4.1/js/dataTables.buttons.min.js"></script>
  <script src="https://cdn.datatables.net/buttons/2.4.1/js/buttons.html5.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.2.7/pdfmake.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.2.7/vfs_fonts.js"></script>
  <style>
    body {
      background-color: #0b1d3a; /* Navy Blue */
      color: #fff;
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 20px;
    }
    .container {
      background: #fff;
      color: #000;
      border-radius: 15px;
      padding: 20px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.3);
    }
    h2 {
      text-align: center;
      margin-bottom: 10px;
    }
    .top-bar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }
    .logo {
      height: 50px;
    }
    .btn {
      background-color: #f7c400; /* Golden Yellow */
      border: none;
      color: #000;
      padding: 10px 15px;
      border-radius: 5px;
      font-weight: bold;
      cursor: pointer;
      transition: 0.3s;
    }
    .btn:hover {
      background-color: #ddb200;
    }
    table.dataTable thead .sorting:after,
    table.dataTable thead .sorting_asc:after,
    table.dataTable thead .sorting_desc:after {
      color: #000;
    }
    table.dataTable th, table.dataTable td {
      white-space: nowrap;
    }
    .dataTables_wrapper .dataTables_filter {
      float: right;
    }
  </style>
</head>
<body>

<div class="top-bar">
  <img src="1.png" alt="Alif Logo" class="logo">
  <button class="btn" onclick="window.location.href='admin.html'">Go to Dashboard</button>
</div>

<div class="container">
  <h2>Principal Logbook Report</h2>
  <table id="logbookTable" class="display nowrap" style="width:100%">
    <thead>
      <tr>
        <th>Timestamp</th>
        <th>Date</th>
        <th>Teacher's Name</th>
        <th>Staff ID</th>
        <th>Program</th>
        <th>Class</th>
        <th>Student Name</th>
        <th>Subjects</th>
        <th>Class In</th>
        <th>Class Duration</th>
        <th>What did you teach today?</th>
        <th>Student Engagement</th>
        <th>Homework or Tasks Given?</th>
        <th>What type of Work</th>
        <th>Upload Class Notification Message</th>
        <th>Anything you'd like to share?</th>
      </tr>
    </thead>
  </table>
</div>

<script>
$(document).ready(function() {
  const sheetURL = 'https://script.google.com/macros/s/AKfycby51sQL3xo9pIqc7WO6-gUCQhCpkL0JN-4HclaAWbjaRsDrUCD4gD7zc47PVSfn9A8jgA/exec'; // Replace this

  fetch(sheetURL)
    .then(res => res.json())
    .then(data => {
      $('#logbookTable').DataTable({
        data: data,
        columns: [
          { data: 'Timestamp' },
          { data: 'Date' },
          { data: "Teacher's Name" },
          { data: 'Staff ID' },
          { data: 'Program' },
          { data: 'Class' },
          { data: 'Student Name' },
          { data: 'Subjects' },
          { data: 'Class In' },
          { data: 'Class Duration' },
          { data: 'What did you teach today?' },
          { data: 'Student Engagement' },
          { data: 'Homework or Tasks Given?' },
          { data: 'What type of Work' },
          { data: 'Upload Class Notification Message' },
          { data: "Anything you'd like to share?" }
        ],
        dom: 'Bfrtip',
        buttons: [
          {
            extend: 'pdfHtml5',
            text: 'Download PDF',
            className: 'btn',
            title: 'Alif Edu - Logbook Report',
            customize: function (doc) {
              doc.styles.tableHeader.alignment = 'left';
              doc.styles.title = {
                alignment: 'center',
                fontSize: 18,
                bold: true,
                margin: [0, 0, 0, 15]
              };
              doc.content.splice(0, 0, {
                image: 'data:image/png;base64,...', // Replace with base64 Alif logo
                width: 60,
                alignment: 'left',
                margin: [0, 0, 0, 10]
              });
              doc.pageMargins = [20, 60, 20, 30];
              doc.defaultStyle.fontSize = 9;
            }
          }
        ],
        scrollX: true,
        responsive: true,
        initComplete: function () {
          this.api().columns().every(function () {
            var column = this;
            var select = $('<select><option value="">All</option></select>')
              .appendTo($(column.header()).empty())
              .on('change', function () {
                var val = $.fn.dataTable.util.escapeRegex($(this).val());
                column.search(val ? '^' + val + '$' : '', true, false).draw();
              });
            column.data().unique().sort().each(function (d, j) {
              if (d) select.append('<option value="' + d + '">' + d + '</option>')
            });
          });
        }
      });
    })
    .catch(error => console.error('Error loading data:', error));
});
</script>

</body>
</html>
